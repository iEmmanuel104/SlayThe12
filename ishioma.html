<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>12 Week Year</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  <style>
    * { font-family: 'Poppins', sans-serif; }
  </style>
</head>
<body>
  <div id="app"></div>

  <script>
    // Motivational quotes
    const motivationalQuotes = [
      "The 12 Week Year creates urgency and clarity. Execute daily!",
      "Your focus determines your reality. What will you accomplish this week?",
      "Execution is the single greatest market differentiator.",
      "Greatness is not a function of circumstance, it's a function of choice.",
      "The secret to getting ahead is getting started.",
      "Don't count the days, make the days count.",
      "Small daily improvements over time lead to stunning results.",
      "Your goals are waiting. Take action today!"
    ];

    // App State
    let state = {
      activeTab: 'goals',
      goals: [],
      weeklyTasks: {},
      currentWeek: 1,
      showAddGoal: false,
      newGoal: '',
      newTask: '',
      taskTime: '',
      selectedGoalId: null,
      dailyTodos: {},
      newDailyTodo: '',
      currentDate: new Date().toISOString().split('T')[0],
      weeklyMeasurements: {},
      accountabilityCircle: [],
      newPartner: { name: '', email: '', phone: '' },
      vision: '',
      visionImages: [],
      blockedApps: [],
      newBlockedApp: '',
      quote: motivationalQuotes[0]
    };

    // Load data from localStorage
    function loadData() {
      try {
        const saved = localStorage.getItem('twelve-week-year-data');
        if (saved) {
          const data = JSON.parse(saved);
          state.goals = data.goals || [];
          state.weeklyTasks = data.weeklyTasks || {};
          state.currentWeek = data.currentWeek || 1;
          state.dailyTodos = data.dailyTodos || {};
          state.weeklyMeasurements = data.weeklyMeasurements || {};
          state.accountabilityCircle = data.accountabilityCircle || [];
          state.vision = data.vision || '';
          state.visionImages = data.visionImages || [];
          state.blockedApps = data.blockedApps || [];
        }
      } catch (e) {
        console.log('No saved data found');
      }
    }

    // Save data to localStorage
    function saveData() {
      const data = {
        goals: state.goals,
        weeklyTasks: state.weeklyTasks,
        currentWeek: state.currentWeek,
        dailyTodos: state.dailyTodos,
        weeklyMeasurements: state.weeklyMeasurements,
        accountabilityCircle: state.accountabilityCircle,
        vision: state.vision,
        visionImages: state.visionImages,
        blockedApps: state.blockedApps
      };
      localStorage.setItem('twelve-week-year-data', JSON.stringify(data));
    }

    // Calculate progress for a goal
    function calculateProgress(goalId) {
      const tasks = state.weeklyTasks[goalId] || {};
      const allTasks = Object.values(tasks).flat();
      if (allTasks.length === 0) return 0;
      const completed = allTasks.filter(t => t.completed).length;
      return Math.round((completed / allTasks.length) * 100);
    }

    // Get overall progress
    function getOverallProgress() {
      if (state.goals.length === 0) return 0;
      return Math.round(state.goals.reduce((sum, g) => sum + calculateProgress(g.id), 0) / state.goals.length);
    }

    // Get tasks for a specific week
    function getWeekTasks(goalId, week) {
      return state.weeklyTasks[goalId]?.[week] || [];
    }

    // Render the app
    function render() {
      const app = document.getElementById('app');
      state.quote = motivationalQuotes[Math.floor(Math.random() * motivationalQuotes.length)];

      app.innerHTML = `
        <div class="min-h-screen bg-gradient-to-br from-pink-50 via-rose-50 to-fuchsia-100 p-6">
          <div class="max-w-7xl mx-auto">
            <!-- Header Card -->
            <div class="bg-white/70 backdrop-blur-md border border-white/20 rounded-2xl shadow-xl shadow-pink-100/30 p-6 mb-6">
              <div class="flex items-center justify-between mb-4">
                <div class="flex items-center gap-3">
                  <i data-lucide="target" class="text-rose-500 w-8 h-8"></i>
                  <h1 class="text-3xl font-bold text-gray-800">12 Week Year</h1>
                </div>
                <div class="flex items-center gap-4">
                  <div class="text-right">
                    <div class="text-sm text-gray-500">Week ${state.currentWeek} Progress</div>
                    <div class="text-2xl font-bold text-rose-500">${getOverallProgress()}%</div>
                  </div>
                </div>
              </div>

              <div class="bg-pink-50/80 backdrop-blur-sm rounded-lg p-4 mb-4 flex items-start gap-3 border border-pink-100/50">
                <i data-lucide="lightbulb" class="text-rose-500 flex-shrink-0 mt-1 w-5 h-5"></i>
                <p class="text-rose-900 italic">${state.quote}</p>
              </div>

              <div class="flex items-center justify-between mb-4">
                <div class="flex items-center gap-2 text-sm text-green-600">
                  <i data-lucide="check" class="w-4 h-4"></i>
                  <span>Auto-saved</span>
                </div>
                <button onclick="resetAllData()" class="text-sm text-red-600 hover:text-red-700 underline">
                  Reset All Data
                </button>
              </div>

              <!-- Tabs -->
              <div class="flex gap-2 overflow-x-auto pb-2">
                ${renderTabs()}
              </div>
            </div>

            <!-- Tab Content -->
            ${renderTabContent()}
          </div>
        </div>
      `;

      // Initialize Lucide icons
      lucide.createIcons();
    }

    function renderTabs() {
      const tabs = [
        { id: 'goals', label: 'Goals & Tasks', icon: 'target' },
        { id: 'daily', label: 'Daily To-Do', icon: 'check' },
        { id: 'measurement', label: 'Measurement', icon: 'bar-chart-3' },
        { id: 'progress', label: 'Progress Report', icon: 'award' },
        { id: 'accountability', label: 'Accountability', icon: 'users' },
        { id: 'vision', label: 'Vision Board', icon: 'image' },
        { id: 'blocking', label: 'App Blocking', icon: 'shield' }
      ];

      return tabs.map(tab => `
        <button
          onclick="setActiveTab('${tab.id}')"
          class="flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all duration-300 whitespace-nowrap ${
            state.activeTab === tab.id
              ? 'bg-gradient-to-r from-pink-500 to-rose-500 text-white shadow-lg shadow-pink-200/50'
              : 'bg-white/60 backdrop-blur-sm text-gray-600 hover:bg-white/80 hover:shadow-md hover:shadow-pink-100/30'
          }"
        >
          <i data-lucide="${tab.icon}" class="w-4 h-4"></i>
          ${tab.label}
        </button>
      `).join('');
    }

    function renderTabContent() {
      switch (state.activeTab) {
        case 'goals': return renderGoalsTab();
        case 'daily': return renderDailyTab();
        case 'measurement': return renderMeasurementTab();
        case 'progress': return renderProgressTab();
        case 'accountability': return renderAccountabilityTab();
        case 'vision': return renderVisionTab();
        case 'blocking': return renderBlockingTab();
        default: return '';
      }
    }

    function renderGoalsTab() {
      return `
        <div class="space-y-6">
          <!-- Week Selector -->
          <div class="bg-white/70 backdrop-blur-md border border-white/20 rounded-2xl shadow-xl shadow-pink-100/30 p-6">
            <div class="flex items-center gap-3 mb-4">
              <i data-lucide="calendar" class="text-rose-400 w-5 h-5"></i>
              <h2 class="text-xl font-bold text-gray-800">Select Week</h2>
            </div>
            <div class="flex gap-2 flex-wrap">
              ${Array.from({ length: 12 }, (_, i) => i + 1).map(week => `
                <button
                  onclick="setCurrentWeek(${week})"
                  class="px-4 py-2 rounded-lg font-medium transition-all duration-300 ${
                    state.currentWeek === week
                      ? 'bg-gradient-to-r from-pink-500 to-rose-500 text-white shadow-lg shadow-pink-200/50 scale-[1.02]'
                      : 'bg-white/60 backdrop-blur-sm text-gray-600 hover:bg-white/80 hover:shadow-md hover:shadow-pink-100/30'
                  }"
                >
                  Week ${week}
                </button>
              `).join('')}
            </div>
          </div>

          <!-- Goals List -->
          <div class="bg-white/70 backdrop-blur-md border border-white/20 rounded-2xl shadow-xl shadow-pink-100/30 p-6">
            <div class="flex items-center justify-between mb-6">
              <h2 class="text-2xl font-bold text-gray-800">12-Week Goals</h2>
              <button
                onclick="toggleAddGoal()"
                class="flex items-center gap-2 bg-gradient-to-r from-pink-500 to-rose-500 text-white px-4 py-2 rounded-lg hover:from-pink-600 hover:to-rose-600 transition-all duration-300 hover:scale-[1.02] hover:shadow-lg hover:shadow-pink-200/50"
              >
                <i data-lucide="plus" class="w-5 h-5"></i>
                Add Goal
              </button>
            </div>

            ${state.showAddGoal ? `
              <div class="mb-6 p-4 bg-pink-50/80 backdrop-blur-sm rounded-lg border border-pink-100/50">
                <input
                  type="text"
                  id="newGoalInput"
                  value="${state.newGoal}"
                  oninput="state.newGoal = this.value"
                  onkeypress="if(event.key === 'Enter') addGoal()"
                  placeholder="Enter your 12-week goal..."
                  class="w-full px-4 py-2 bg-white/80 backdrop-blur-sm border border-pink-200/50 rounded-lg mb-2 focus:outline-none focus:ring-2 focus:ring-pink-400"
                  autofocus
                />
                <div class="flex gap-2">
                  <button onclick="addGoal()" class="bg-gradient-to-r from-pink-500 to-rose-500 text-white px-4 py-2 rounded-lg hover:from-pink-600 hover:to-rose-600 transition-all duration-300">
                    Add Goal
                  </button>
                  <button onclick="toggleAddGoal()" class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-all duration-300">
                    Cancel
                  </button>
                </div>
              </div>
            ` : ''}

            ${state.goals.length === 0 ? `
              <div class="text-center py-12 text-gray-400">
                <i data-lucide="target" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
                <p>No goals yet. Add your first 12-week goal to get started!</p>
              </div>
            ` : `
              <div class="space-y-6">
                ${state.goals.map(goal => renderGoalCard(goal)).join('')}
              </div>
            `}
          </div>
        </div>
      `;
    }

    function renderGoalCard(goal) {
      const progress = calculateProgress(goal.id);
      const weekTasks = getWeekTasks(goal.id, state.currentWeek);

      return `
        <div class="bg-white/50 backdrop-blur-sm border border-white/30 rounded-xl p-6 transition-all duration-300 hover:-translate-y-1 hover:shadow-xl hover:shadow-pink-100/30">
          <div class="flex items-start justify-between mb-4">
            <div class="flex-1">
              <h3 class="text-xl font-semibold text-gray-800 mb-2">${goal.title}</h3>
              <div class="flex items-center gap-4">
                <div class="flex-1 bg-gray-200/70 rounded-full h-3">
                  <div class="bg-gradient-to-r from-pink-400 to-rose-500 h-3 rounded-full transition-all duration-700 ease-out" style="width: ${progress}%"></div>
                </div>
                <span class="text-sm font-medium text-rose-500">${progress}%</span>
              </div>
            </div>
            <button onclick="deleteGoal(${goal.id})" class="text-red-500 hover:text-red-700 p-2 transition-all duration-300">
              <i data-lucide="trash-2" class="w-5 h-5"></i>
            </button>
          </div>

          <div class="mt-4">
            <h4 class="text-sm font-medium text-gray-600 mb-3">Week ${state.currentWeek} Tasks</h4>

            ${weekTasks.map(task => `
              <div class="flex items-center gap-3 mb-2 group">
                <button
                  onclick="toggleTask(${goal.id}, ${state.currentWeek}, ${task.id})"
                  class="w-5 h-5 rounded border-2 flex items-center justify-center transition-transform duration-200 active:scale-90 flex-shrink-0 ${
                    task.completed
                      ? 'bg-gradient-to-r from-pink-500 to-rose-500 border-pink-500'
                      : 'border-gray-300 hover:border-pink-400'
                  }"
                >
                  ${task.completed ? '<i data-lucide="check" class="w-3 h-3 text-white"></i>' : ''}
                </button>
                <span class="flex-1 ${task.completed ? 'line-through text-gray-400' : 'text-gray-700'}">${task.text}</span>
                ${task.time ? `
                  <div class="flex items-center gap-1 text-gray-500 text-sm">
                    <i data-lucide="clock" class="w-3 h-3"></i>
                    <span>${task.time}</span>
                  </div>
                ` : ''}
                <button onclick="deleteTask(${goal.id}, ${state.currentWeek}, ${task.id})" class="opacity-0 group-hover:opacity-100 text-red-500 hover:text-red-700 transition-all duration-300">
                  <i data-lucide="trash-2" class="w-4 h-4"></i>
                </button>
              </div>
            `).join('')}

            ${state.selectedGoalId === goal.id ? `
              <div class="mt-3 space-y-2">
                <input
                  type="text"
                  id="newTaskInput"
                  value="${state.newTask}"
                  oninput="state.newTask = this.value"
                  onkeypress="if(event.key === 'Enter') addTask(${goal.id})"
                  placeholder="Task description..."
                  class="w-full px-3 py-2 bg-white/80 backdrop-blur-sm border border-pink-200/50 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400"
                  autofocus
                />
                <input
                  type="text"
                  value="${state.taskTime}"
                  oninput="state.taskTime = this.value"
                  placeholder="Time estimate (e.g., 2 hours, 30 mins)"
                  class="w-full px-3 py-2 bg-white/80 backdrop-blur-sm border border-pink-200/50 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400"
                />
                <div class="flex gap-2">
                  <button onclick="addTask(${goal.id})" class="bg-gradient-to-r from-pink-500 to-rose-500 text-white px-4 py-2 rounded-lg hover:from-pink-600 hover:to-rose-600 transition-all duration-300">
                    Add Task
                  </button>
                  <button onclick="cancelAddTask()" class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-all duration-300">
                    Cancel
                  </button>
                </div>
              </div>
            ` : `
              <button onclick="selectGoalForTask(${goal.id})" class="mt-3 flex items-center gap-2 text-rose-500 hover:text-rose-600 text-sm font-medium transition-all duration-300">
                <i data-lucide="plus" class="w-4 h-4"></i>
                Add Task for Week ${state.currentWeek}
              </button>
            `}
          </div>
        </div>
      `;
    }

    function renderDailyTab() {
      const todaysTodos = state.dailyTodos[state.currentDate] || [];

      return `
        <div class="bg-white/70 backdrop-blur-md border border-white/20 rounded-2xl shadow-xl shadow-pink-100/30 p-6">
          <div class="flex items-center justify-between mb-6">
            <h2 class="text-2xl font-bold text-gray-800">Daily To-Do List</h2>
            <input
              type="date"
              value="${state.currentDate}"
              onchange="setCurrentDate(this.value)"
              class="px-4 py-2 bg-white/80 backdrop-blur-sm border border-pink-200/50 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400"
            />
          </div>

          <div class="mb-4">
            <div class="flex gap-2">
              <input
                type="text"
                value="${state.newDailyTodo}"
                oninput="state.newDailyTodo = this.value"
                onkeypress="if(event.key === 'Enter') addDailyTodo()"
                placeholder="Add a task for today..."
                class="flex-1 px-4 py-2 bg-white/80 backdrop-blur-sm border border-pink-200/50 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400"
              />
              <button onclick="addDailyTodo()" class="bg-gradient-to-r from-pink-500 to-rose-500 text-white px-6 py-2 rounded-lg hover:from-pink-600 hover:to-rose-600 transition-all duration-300 hover:scale-[1.02] hover:shadow-lg hover:shadow-pink-200/50">
                Add
              </button>
            </div>
          </div>

          <div class="space-y-2">
            ${todaysTodos.length === 0 ? `
              <div class="text-center py-12 text-gray-400">
                <i data-lucide="check" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
                <p>No tasks for today. Add your first task!</p>
              </div>
            ` : todaysTodos.map(todo => `
              <div class="flex items-center gap-3 p-3 bg-white/50 backdrop-blur-sm rounded-lg group transition-all duration-300 hover:bg-white/70">
                <button
                  onclick="toggleDailyTodo(${todo.id})"
                  class="w-6 h-6 rounded border-2 flex items-center justify-center transition-transform duration-200 active:scale-90 flex-shrink-0 ${
                    todo.completed
                      ? 'bg-gradient-to-r from-pink-500 to-rose-500 border-pink-500'
                      : 'border-gray-300 hover:border-pink-400'
                  }"
                >
                  ${todo.completed ? '<i data-lucide="check" class="w-4 h-4 text-white"></i>' : ''}
                </button>
                <span class="flex-1 ${todo.completed ? 'line-through text-gray-400' : 'text-gray-700'}">${todo.text}</span>
                <button onclick="deleteDailyTodo(${todo.id})" class="opacity-0 group-hover:opacity-100 text-red-500 hover:text-red-700 transition-all duration-300">
                  <i data-lucide="trash-2" class="w-4 h-4"></i>
                </button>
              </div>
            `).join('')}
          </div>
        </div>
      `;
    }

    function renderMeasurementTab() {
      return `
        <div class="bg-white/70 backdrop-blur-md border border-white/20 rounded-2xl shadow-xl shadow-pink-100/30 p-6">
          <h2 class="text-2xl font-bold text-gray-800 mb-6">Weekly Measurements</h2>
          <div class="space-y-6">
            ${Array.from({ length: 12 }, (_, i) => i + 1).map(week => `
              <div class="bg-white/50 backdrop-blur-sm border border-white/30 rounded-lg p-4 transition-all duration-300 hover:-translate-y-1 hover:shadow-xl hover:shadow-pink-100/30">
                <h3 class="font-semibold text-gray-800 mb-3">Week ${week}</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div>
                    <label class="block text-sm text-gray-600 mb-1">Tasks Completed</label>
                    <input
                      type="number"
                      value="${state.weeklyMeasurements[week]?.tasksCompleted || ''}"
                      oninput="saveMeasurement(${week}, 'tasksCompleted', this.value)"
                      placeholder="Number of tasks"
                      class="w-full px-3 py-2 bg-white/80 backdrop-blur-sm border border-pink-200/50 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400"
                    />
                  </div>
                  <div>
                    <label class="block text-sm text-gray-600 mb-1">Execution Score (0-100%)</label>
                    <input
                      type="number"
                      value="${state.weeklyMeasurements[week]?.executionScore || ''}"
                      oninput="saveMeasurement(${week}, 'executionScore', this.value)"
                      placeholder="Score"
                      class="w-full px-3 py-2 bg-white/80 backdrop-blur-sm border border-pink-200/50 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400"
                    />
                  </div>
                  <div class="md:col-span-2">
                    <label class="block text-sm text-gray-600 mb-1">Weekly Notes</label>
                    <textarea
                      oninput="saveMeasurement(${week}, 'notes', this.value)"
                      placeholder="Wins, challenges, lessons learned..."
                      class="w-full px-3 py-2 bg-white/80 backdrop-blur-sm border border-pink-200/50 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400"
                      rows="2"
                    >${state.weeklyMeasurements[week]?.notes || ''}</textarea>
                  </div>
                </div>
              </div>
            `).join('')}
          </div>
        </div>
      `;
    }

    function renderProgressTab() {
      return `
        <div class="bg-white/70 backdrop-blur-md border border-white/20 rounded-2xl shadow-xl shadow-pink-100/30 p-6">
          <h2 class="text-2xl font-bold text-gray-800 mb-6">Progress Report</h2>
          <div class="space-y-6">
            ${state.goals.length === 0 ? `
              <div class="text-center py-12 text-gray-400">
                <i data-lucide="award" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
                <p>No goals to report on yet. Create goals to track your progress!</p>
              </div>
            ` : state.goals.map(goal => {
              const progress = calculateProgress(goal.id);
              const allWeekTasks = Object.entries(state.weeklyTasks[goal.id] || {});

              return `
                <div class="bg-white/50 backdrop-blur-sm border border-white/30 rounded-lg p-6 transition-all duration-300 hover:-translate-y-1 hover:shadow-xl hover:shadow-pink-100/30">
                  <h3 class="text-xl font-semibold text-gray-800 mb-4">${goal.title}</h3>
                  <div class="mb-4">
                    <div class="flex items-center justify-between mb-2">
                      <span class="text-sm text-gray-600">Overall Progress</span>
                      <span class="text-lg font-bold text-rose-500">${progress}%</span>
                    </div>
                    <div class="w-full bg-gray-200/70 rounded-full h-4">
                      <div class="bg-gradient-to-r from-pink-400 to-rose-500 h-4 rounded-full transition-all duration-700 ease-out" style="width: ${progress}%"></div>
                    </div>
                  </div>

                  <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                    ${allWeekTasks.map(([week, tasks]) => {
                      const completed = tasks.filter(t => t.completed).length;
                      const total = tasks.length;
                      return `
                        <div class="bg-white/60 backdrop-blur-sm rounded-lg p-3 text-center border border-white/30">
                          <div class="text-xs text-gray-500 mb-1">Week ${week}</div>
                          <div class="text-lg font-bold text-rose-500">${completed}/${total}</div>
                          <div class="text-xs text-gray-500">tasks</div>
                        </div>
                      `;
                    }).join('')}
                  </div>
                </div>
              `;
            }).join('')}
          </div>
        </div>
      `;
    }

    function renderAccountabilityTab() {
      return `
        <div class="bg-white/70 backdrop-blur-md border border-white/20 rounded-2xl shadow-xl shadow-pink-100/30 p-6">
          <h2 class="text-2xl font-bold text-gray-800 mb-6">Accountability Circle</h2>
          <p class="text-gray-600 mb-6">Build your support network. Add people who will hold you accountable to your 12-week goals.</p>

          <div class="mb-6 p-4 bg-pink-50/80 backdrop-blur-sm rounded-lg border border-pink-100/50">
            <h3 class="font-semibold text-gray-800 mb-3">Add Accountability Partner</h3>
            <div class="space-y-3">
              <input
                type="text"
                value="${state.newPartner.name}"
                oninput="state.newPartner.name = this.value"
                placeholder="Name"
                class="w-full px-4 py-2 bg-white/80 backdrop-blur-sm border border-pink-200/50 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400"
              />
              <input
                type="email"
                value="${state.newPartner.email}"
                oninput="state.newPartner.email = this.value"
                placeholder="Email"
                class="w-full px-4 py-2 bg-white/80 backdrop-blur-sm border border-pink-200/50 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400"
              />
              <input
                type="tel"
                value="${state.newPartner.phone}"
                oninput="state.newPartner.phone = this.value"
                placeholder="Phone (optional)"
                class="w-full px-4 py-2 bg-white/80 backdrop-blur-sm border border-pink-200/50 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400"
              />
              <button onclick="addAccountabilityPartner()" class="bg-gradient-to-r from-pink-500 to-rose-500 text-white px-6 py-2 rounded-lg hover:from-pink-600 hover:to-rose-600 transition-all duration-300 hover:scale-[1.02] hover:shadow-lg hover:shadow-pink-200/50">
                Add Partner
              </button>
            </div>
          </div>

          <div class="space-y-3">
            ${state.accountabilityCircle.length === 0 ? `
              <div class="text-center py-12 text-gray-400">
                <i data-lucide="users" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
                <p>No accountability partners yet. Add someone to your circle!</p>
              </div>
            ` : state.accountabilityCircle.map(partner => `
              <div class="flex items-center justify-between p-4 bg-white/50 backdrop-blur-sm rounded-lg border border-white/30 transition-all duration-300 hover:bg-white/70">
                <div>
                  <h4 class="font-semibold text-gray-800">${partner.name}</h4>
                  ${partner.email ? `<p class="text-sm text-gray-600">${partner.email}</p>` : ''}
                  ${partner.phone ? `<p class="text-sm text-gray-600">${partner.phone}</p>` : ''}
                </div>
                <button onclick="deletePartner(${partner.id})" class="text-red-500 hover:text-red-700 transition-all duration-300">
                  <i data-lucide="trash-2" class="w-5 h-5"></i>
                </button>
              </div>
            `).join('')}
          </div>
        </div>
      `;
    }

    function renderVisionTab() {
      return `
        <div class="bg-white/70 backdrop-blur-md border border-white/20 rounded-2xl shadow-xl shadow-pink-100/30 p-6">
          <h2 class="text-2xl font-bold text-gray-800 mb-6">Vision Board</h2>
          <p class="text-gray-600 mb-6">Define your vision. What do you want to achieve in these 12 weeks?</p>

          <div class="mb-6">
            <h3 class="font-semibold text-gray-800 mb-3">Your Vision Statement</h3>
            <textarea
              oninput="updateVision(this.value)"
              placeholder="Write your compelling vision for the next 12 weeks..."
              class="w-full px-4 py-3 bg-white/80 backdrop-blur-sm border border-pink-200/50 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400"
              rows="6"
            >${state.vision}</textarea>
          </div>

          <div>
            <div class="flex items-center justify-between mb-3">
              <h3 class="font-semibold text-gray-800">Vision Images</h3>
              <button onclick="addVisionImage()" class="flex items-center gap-2 bg-gradient-to-r from-pink-500 to-rose-500 text-white px-4 py-2 rounded-lg hover:from-pink-600 hover:to-rose-600 transition-all duration-300 hover:scale-[1.02] hover:shadow-lg hover:shadow-pink-200/50">
                <i data-lucide="plus" class="w-4 h-4"></i>
                Add Image
              </button>
            </div>

            ${state.visionImages.length === 0 ? `
              <div class="text-center py-12 border-2 border-dashed border-pink-200 rounded-lg text-gray-400 bg-white/30 backdrop-blur-sm">
                <i data-lucide="image" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
                <p>No images yet. Add inspiring images to visualize your goals!</p>
              </div>
            ` : `
              <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                ${state.visionImages.map(img => `
                  <div class="relative group overflow-hidden rounded-lg">
                    <img
                      src="${img.url}"
                      alt="Vision"
                      class="w-full h-48 object-cover rounded-lg transition-all duration-300 group-hover:scale-105"
                      onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22200%22 height=%22200%22%3E%3Crect fill=%22%23ddd%22 width=%22200%22 height=%22200%22/%3E%3Ctext fill=%22%23999%22 x=%2250%25%22 y=%2250%25%22 text-anchor=%22middle%22 dy=%22.3em%22%3EImage%3C/text%3E%3C/svg%3E'"
                    />
                    <div class="absolute inset-0 bg-gradient-to-t from-pink-500/30 to-transparent opacity-0 group-hover:opacity-100 transition-all duration-300 rounded-lg"></div>
                    <button onclick="deleteVisionImage(${img.id})" class="absolute top-2 right-2 bg-red-500 text-white p-2 rounded-lg opacity-0 group-hover:opacity-100 transition-all duration-300">
                      <i data-lucide="trash-2" class="w-4 h-4"></i>
                    </button>
                  </div>
                `).join('')}
              </div>
            `}
          </div>
        </div>
      `;
    }

    function renderBlockingTab() {
      return `
        <div class="bg-white/70 backdrop-blur-md border border-white/20 rounded-2xl shadow-xl shadow-pink-100/30 p-6">
          <h2 class="text-2xl font-bold text-gray-800 mb-6">App Blocking</h2>
          <p class="text-gray-600 mb-6">List apps and websites you want to avoid during focused work time.</p>

          <div class="mb-6">
            <div class="flex gap-2">
              <input
                type="text"
                value="${state.newBlockedApp}"
                oninput="state.newBlockedApp = this.value"
                onkeypress="if(event.key === 'Enter') addBlockedApp()"
                placeholder="App or website name (e.g., Facebook, Twitter)"
                class="flex-1 px-4 py-2 bg-white/80 backdrop-blur-sm border border-pink-200/50 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400"
              />
              <button onclick="addBlockedApp()" class="bg-gradient-to-r from-pink-500 to-rose-500 text-white px-6 py-2 rounded-lg hover:from-pink-600 hover:to-rose-600 transition-all duration-300 hover:scale-[1.02] hover:shadow-lg hover:shadow-pink-200/50">
                Add
              </button>
            </div>
          </div>

          <div class="space-y-2">
            ${state.blockedApps.length === 0 ? `
              <div class="text-center py-12 text-gray-400">
                <i data-lucide="shield" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
                <p>No blocked apps yet. Add distracting apps to stay focused!</p>
              </div>
            ` : state.blockedApps.map(app => `
              <div class="flex items-center justify-between p-4 bg-white/50 backdrop-blur-sm rounded-lg border border-white/30 transition-all duration-300 hover:bg-white/70">
                <div class="flex items-center gap-3">
                  <button
                    onclick="toggleBlockedApp(${app.id})"
                    class="w-12 h-6 rounded-full transition-all duration-300 ${app.blocked ? 'bg-gradient-to-r from-pink-500 to-rose-500' : 'bg-gray-300'}"
                  >
                    <div class="w-5 h-5 bg-white rounded-full shadow-md transition-all duration-300 transform ${app.blocked ? 'translate-x-6' : 'translate-x-1'}"></div>
                  </button>
                  <span class="font-medium ${app.blocked ? 'text-gray-800' : 'text-gray-400'}">${app.name}</span>
                  <span class="text-xs px-2 py-1 rounded transition-all duration-300 ${app.blocked ? 'bg-pink-100 text-pink-700' : 'bg-gray-200 text-gray-600'}">
                    ${app.blocked ? 'Blocked' : 'Allowed'}
                  </span>
                </div>
                <button onclick="deleteBlockedApp(${app.id})" class="text-red-500 hover:text-red-700 transition-all duration-300">
                  <i data-lucide="trash-2" class="w-5 h-5"></i>
                </button>
              </div>
            `).join('')}
          </div>
        </div>
      `;
    }

    // Action functions
    function setActiveTab(tab) {
      state.activeTab = tab;
      render();
    }

    function setCurrentWeek(week) {
      state.currentWeek = week;
      saveData();
      render();
    }

    function setCurrentDate(date) {
      state.currentDate = date;
      render();
    }

    function toggleAddGoal() {
      state.showAddGoal = !state.showAddGoal;
      state.newGoal = '';
      render();
    }

    function addGoal() {
      if (state.newGoal.trim()) {
        state.goals.push({
          id: Date.now(),
          title: state.newGoal,
          createdAt: new Date().toISOString()
        });
        state.newGoal = '';
        state.showAddGoal = false;
        saveData();
        render();
      }
    }

    function deleteGoal(id) {
      state.goals = state.goals.filter(g => g.id !== id);
      delete state.weeklyTasks[id];
      saveData();
      render();
    }

    function selectGoalForTask(goalId) {
      state.selectedGoalId = goalId;
      render();
    }

    function cancelAddTask() {
      state.selectedGoalId = null;
      state.newTask = '';
      state.taskTime = '';
      render();
    }

    function addTask(goalId) {
      if (state.newTask.trim()) {
        if (!state.weeklyTasks[goalId]) state.weeklyTasks[goalId] = {};
        if (!state.weeklyTasks[goalId][state.currentWeek]) state.weeklyTasks[goalId][state.currentWeek] = [];

        state.weeklyTasks[goalId][state.currentWeek].push({
          id: Date.now(),
          text: state.newTask,
          time: state.taskTime,
          completed: false
        });

        state.newTask = '';
        state.taskTime = '';
        state.selectedGoalId = null;
        saveData();
        render();
      }
    }

    function toggleTask(goalId, week, taskId) {
      const tasks = state.weeklyTasks[goalId][week];
      const task = tasks.find(t => t.id === taskId);
      if (task) {
        task.completed = !task.completed;
        saveData();
        render();
      }
    }

    function deleteTask(goalId, week, taskId) {
      state.weeklyTasks[goalId][week] = state.weeklyTasks[goalId][week].filter(t => t.id !== taskId);
      saveData();
      render();
    }

    function addDailyTodo() {
      if (state.newDailyTodo.trim()) {
        if (!state.dailyTodos[state.currentDate]) state.dailyTodos[state.currentDate] = [];
        state.dailyTodos[state.currentDate].push({
          id: Date.now(),
          text: state.newDailyTodo,
          completed: false
        });
        state.newDailyTodo = '';
        saveData();
        render();
      }
    }

    function toggleDailyTodo(todoId) {
      const todos = state.dailyTodos[state.currentDate];
      const todo = todos.find(t => t.id === todoId);
      if (todo) {
        todo.completed = !todo.completed;
        saveData();
        render();
      }
    }

    function deleteDailyTodo(todoId) {
      state.dailyTodos[state.currentDate] = state.dailyTodos[state.currentDate].filter(t => t.id !== todoId);
      saveData();
      render();
    }

    function saveMeasurement(week, metric, value) {
      if (!state.weeklyMeasurements[week]) state.weeklyMeasurements[week] = {};
      state.weeklyMeasurements[week][metric] = value;
      saveData();
    }

    function addAccountabilityPartner() {
      if (state.newPartner.name.trim()) {
        state.accountabilityCircle.push({
          id: Date.now(),
          ...state.newPartner
        });
        state.newPartner = { name: '', email: '', phone: '' };
        saveData();
        render();
      }
    }

    function deletePartner(id) {
      state.accountabilityCircle = state.accountabilityCircle.filter(p => p.id !== id);
      saveData();
      render();
    }

    function updateVision(value) {
      state.vision = value;
      saveData();
    }

    function addVisionImage() {
      const url = prompt('Enter image URL for your vision board:');
      if (url) {
        state.visionImages.push({ id: Date.now(), url });
        saveData();
        render();
      }
    }

    function deleteVisionImage(id) {
      state.visionImages = state.visionImages.filter(img => img.id !== id);
      saveData();
      render();
    }

    function addBlockedApp() {
      if (state.newBlockedApp.trim()) {
        state.blockedApps.push({
          id: Date.now(),
          name: state.newBlockedApp,
          blocked: true
        });
        state.newBlockedApp = '';
        saveData();
        render();
      }
    }

    function toggleBlockedApp(id) {
      const app = state.blockedApps.find(a => a.id === id);
      if (app) {
        app.blocked = !app.blocked;
        saveData();
        render();
      }
    }

    function deleteBlockedApp(id) {
      state.blockedApps = state.blockedApps.filter(a => a.id !== id);
      saveData();
      render();
    }

    function resetAllData() {
      if (confirm('Are you sure you want to reset all data? This cannot be undone.')) {
        localStorage.removeItem('twelve-week-year-data');
        state = {
          activeTab: 'goals',
          goals: [],
          weeklyTasks: {},
          currentWeek: 1,
          showAddGoal: false,
          newGoal: '',
          newTask: '',
          taskTime: '',
          selectedGoalId: null,
          dailyTodos: {},
          newDailyTodo: '',
          currentDate: new Date().toISOString().split('T')[0],
          weeklyMeasurements: {},
          accountabilityCircle: [],
          newPartner: { name: '', email: '', phone: '' },
          vision: '',
          visionImages: [],
          blockedApps: [],
          newBlockedApp: '',
          quote: motivationalQuotes[0]
        };
        render();
        alert('All data has been reset!');
      }
    }

    // Initialize the app
    loadData();
    render();
  </script>
</body>
</html>
